"SelectOfferProp"in window||"function"==typeof window.SelectOfferProp||(SelectOfferProp=function(e){let t=$(this),a={},s={},r=parseUrlQuery(),o=!!t.hasClass("list_values_wrapper"),p=t.closest(".bx_catalog_item_scu"),l=t.closest(".item-parent").find(".thumb img"),n=t.closest(".product-main").length,f=t.closest(".cur").data("code"),c=t.closest(".item_wrapper").siblings().length,_=n?p.closest(".product-main"):p.closest(".item"),d=_.find(".offers-template-json:first").prop("content");offersTree=$(d).find("div").data("json");let E=t.closest(".item-parent").find(".article_block").data("name"),u=t.closest(".item-parent").find(".article_block").data("value"),m=l.data("src")?l.data("src"):l.attr("src");a={PARAMS:n?$(".js-sku-config").data("params"):t.closest(".js_wrapper_items").data("params"),ID:p.data("id"),LINK_ID:p.data("id")+"_"+(n?"detail":f||"block"),PROPERTY_ID:p.data("propertyid"),DEPTH:t.closest(".item_wrapper").index(),VALUE:o?t.find("option:selected").data("onevalue"):t.data("onevalue"),PICTURE:m||"",ARTICLE_NAME:E||"",ARTICLE_VALUE:u||""},"clear_cache"in r&&"Y"==r.clear_cache&&(a.CLEAR_CACHE="Y"),$(".bx_catalog_item_scu").removeClass("js-selected"),p.addClass("js-selected");for(i=0;i<c+1;i++)strName="PROP_"+p.find(".item_wrapper:eq("+i+") > div").data("id"),p.find(".item_wrapper:eq("+i+") select").length?s[strName]=p.find(".item_wrapper:eq("+i+") select option[selected]").data("onevalue"):s[strName]=p.find(".item_wrapper:eq("+i+") li.item.active").data("onevalue");o||(t.siblings().removeClass("active"),t.addClass("active")),appAspro.sku.init({selectedValues:s,strPropValue:a.VALUE,depth:a.DEPTH,isDetail:!!n});const D=appAspro.sku.GetCurrentOfferIndex(offersTree);if(offersTree&&"array"===typeofExt(offersTree)){appAspro.sku.UpdateSKUInfoByProps(offersTree);const e=appAspro.sku.GetCurrentOfferIndex(offersTree);if(D===e)return;I=t.closest(".sku_props").find(".item_wrapper .item.active, .item_wrapper select.list_values_wrapper"),$.each(I,(function(e,t){var a="";if((t=$(t)).attr("title"))a=t.attr("title").split(":")[1].trim();else if("SELECT"===t.prop("tagName")&&void 0!==t.val())a=t.val();else{var s=t.find(" > i");s.length&&s.attr("title")&&(a=s.attr("title").split(":")[1].trim())}""!=a&&t.closest(".item_wrapper").find(".show_class .val").text(a)})),a.SELECTED_OFFER_INDEX=e,a.SELECTED_OFFER_ID=offersTree[a.SELECTED_OFFER_INDEX].ID,appAspro.sku.obOffers[a.SELECTED_OFFER_ID]&&_.is(appAspro.sku.obOffers[a.SELECTED_OFFER_ID].item)?(appAspro.sku.ChangeInfo(_,a.SELECTED_OFFER_ID),A(appAspro.sku.obOffers[a.SELECTED_OFFER_ID],_)):(appAspro.sku.xhr[a.ID]&&appAspro.sku.xhr[a.ID].abort(),BX.ajax.runAction("aspro:max.SelectOffer.select",{data:{params:a},onrequeststart:function(e){appAspro.sku.xhr[a.ID]=e}}).then((e=>{appAspro.sku.obOffers[a.SELECTED_OFFER_ID]=e.data.offer,appAspro.sku.mainItemForOffers=e.data.mainItemForOffers,appAspro.sku.obOffers[a.SELECTED_OFFER_ID].item=_,appAspro.sku.ChangeInfo(_,a.SELECTED_OFFER_ID),delete appAspro.sku.xhr[a.ID],A(appAspro.sku.obOffers[a.SELECTED_OFFER_ID],_)}),(e=>{})))}var I;function A(e,t){$(".counter_wrapp.list")&&$(".counter_wrapp.list .counter_block.big").removeClass("big");var a={offer:e,wrapper:t};BX.onCustomEvent("onFinalActionSKUInfo",[a])}},$(document).on("click",".bx_catalog_item_scu li.item",SelectOfferProp),$(document).on("change",".bx_catalog_item_scu select.list_values_wrapper",SelectOfferProp));